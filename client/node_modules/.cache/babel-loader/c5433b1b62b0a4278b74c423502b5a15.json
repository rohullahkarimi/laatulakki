{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.genDts = void 0;\nvar flatten_1 = __importDefault(require(\"lodash/flatten\"));\nvar isArray_1 = __importDefault(require(\"lodash/isArray\"));\nvar map_1 = __importDefault(require(\"lodash/map\"));\nvar reduce_1 = __importDefault(require(\"lodash/reduce\"));\nvar uniq_1 = __importDefault(require(\"lodash/uniq\"));\nvar upperFirst_1 = __importDefault(require(\"lodash/upperFirst\"));\nfunction genDts(model, options) {\n  var contentParts = [];\n  contentParts = contentParts.concat(\"import type { CstNode, ICstVisitor, IToken } from \\\"chevrotain\\\";\");\n  contentParts = contentParts.concat((0, flatten_1.default)((0, map_1.default)(model, function (node) {\n    return genCstNodeTypes(node);\n  })));\n  if (options.includeVisitorInterface) {\n    contentParts = contentParts.concat(genVisitor(options.visitorInterfaceName, model));\n  }\n  return contentParts.join(\"\\n\\n\") + \"\\n\";\n}\nexports.genDts = genDts;\nfunction genCstNodeTypes(node) {\n  var nodeCstInterface = genNodeInterface(node);\n  var nodeChildrenInterface = genNodeChildrenType(node);\n  return [nodeCstInterface, nodeChildrenInterface];\n}\nfunction genNodeInterface(node) {\n  var nodeInterfaceName = getNodeInterfaceName(node.name);\n  var childrenTypeName = getNodeChildrenTypeName(node.name);\n  return \"export interface \".concat(nodeInterfaceName, \" extends CstNode {\\n  name: \\\"\").concat(node.name, \"\\\";\\n  children: \").concat(childrenTypeName, \";\\n}\");\n}\nfunction genNodeChildrenType(node) {\n  var typeName = getNodeChildrenTypeName(node.name);\n  return \"export type \".concat(typeName, \" = {\\n  \").concat((0, map_1.default)(node.properties, function (property) {\n    return genChildProperty(property);\n  }).join(\"\\n  \"), \"\\n};\");\n}\nfunction genChildProperty(prop) {\n  var typeName = buildTypeString(prop.type);\n  return \"\".concat(prop.name).concat(prop.optional ? \"?\" : \"\", \": \").concat(typeName, \"[];\");\n}\nfunction genVisitor(name, nodes) {\n  return \"export interface \".concat(name, \"<IN, OUT> extends ICstVisitor<IN, OUT> {\\n  \").concat((0, map_1.default)(nodes, function (node) {\n    return genVisitorFunction(node);\n  }).join(\"\\n  \"), \"\\n}\");\n}\nfunction genVisitorFunction(node) {\n  var childrenTypeName = getNodeChildrenTypeName(node.name);\n  return \"\".concat(node.name, \"(children: \").concat(childrenTypeName, \", param?: IN): OUT;\");\n}\nfunction buildTypeString(type) {\n  if ((0, isArray_1.default)(type)) {\n    var typeNames = (0, uniq_1.default)((0, map_1.default)(type, function (t) {\n      return getTypeString(t);\n    }));\n    var typeString = (0, reduce_1.default)(typeNames, function (sum, t) {\n      return sum + \" | \" + t;\n    });\n    return \"(\" + typeString + \")\";\n  } else {\n    return getTypeString(type);\n  }\n}\nfunction getTypeString(type) {\n  if (type.kind === \"token\") {\n    return \"IToken\";\n  }\n  return getNodeInterfaceName(type.name);\n}\nfunction getNodeInterfaceName(ruleName) {\n  return (0, upperFirst_1.default)(ruleName) + \"CstNode\";\n}\nfunction getNodeChildrenTypeName(ruleName) {\n  return (0, upperFirst_1.default)(ruleName) + \"CstChildren\";\n}","map":{"version":3,"names":["flatten_1","__importDefault","require","isArray_1","map_1","reduce_1","uniq_1","upperFirst_1","genDts","model","options","contentParts","concat","default","node","genCstNodeTypes","includeVisitorInterface","genVisitor","visitorInterfaceName","join","exports","nodeCstInterface","genNodeInterface","nodeChildrenInterface","genNodeChildrenType","nodeInterfaceName","getNodeInterfaceName","name","childrenTypeName","getNodeChildrenTypeName","typeName","properties","property","genChildProperty","prop","buildTypeString","type","optional","nodes","genVisitorFunction","typeNames","t","getTypeString","typeString","sum","kind","ruleName"],"sources":["../../src/generate.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script"}